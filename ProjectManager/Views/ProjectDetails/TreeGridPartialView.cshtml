@using ProjectManager.Models
@model IEnumerable<ProjectManager.Models.Tasks>

<table id="treeGrid" class="table table-bordered table-hover tree">
    <thead class="panel-heading">
        <tr>
            <th>@Html.DisplayNameFor(m => m.TaskName)</th>
            <th><a href="#"><i class="fas fa-plus"></i></a></th>
            <th>@Html.DisplayNameFor(m => m.TaskStatusID)</th>
            <th>@Html.DisplayNameFor(m => m.EmployeeGUID)</th>
            <th>預計區間</th>
            @*<th>實際區間</th>*@
            <th>@Html.DisplayNameFor(m => m.Description)</th>
            <th>@Html.DisplayNameFor(m => m.Tag)</th>
            <th>驗收</th>
        </tr>
    </thead>
    <tbody>

        @foreach (var task in @Model)
        {
            var class1 = "treegrid-" + task.orderID;
            var class2 = task.parentOrderID == 0 ? "" : "treegrid-parent-" + task.parentOrderID;
            <tr class="@class1 @class2" data-orderID="@task.orderID" data-taskGUID="@task.TaskGUID">
                <td>@task.TaskName</td>
                <td><a href="#"><i class="fas fa-plus"></i></a></td>
                <td>@task.TaskStatus.TaskStatusName</td>
                <td>@Html.DisplayFor(m => task.Employee.EmployeeName)</td>
                <td>@Html.DisplayFor(m => task.EstStartDate) - @Html.DisplayFor(m => task.EstEndDate)</td>
                @*<td>@Html.DisplayFor(m=>task.StartDate) - @Html.DisplayFor(m=>task.EndDate)</td>*@
                <td>@Html.DisplayFor(m => task.Description)</td>
                <td>@Html.DisplayFor(m => task.Tag)</td>
                <td class="p-0 align-middle">
                    @{ 
                        TasksBL.Task_Status status = (TasksBL.Task_Status)Enum.Parse(typeof(TasksBL.Task_Status), task.TaskStatusID.ToString());
                        if (status == TasksBL.Task_Status.WaitForConfirmed)
                        {
                            <button class="btn btn-default mr-2 p-2" data-taskGUID="@task.TaskGUID">駁回</button>
                            <button class="btn btn-info p-2" data-taskGUID="@task.TaskGUID">通過</button>
                        }
                    }

                </td>
            </tr>
}
    /**/
    </tbody>
</table>
